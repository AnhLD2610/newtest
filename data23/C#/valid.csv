body,code,title
This is my Table : PupilNutritionMy another table Nutrition : This is one field to store final Rate : Case 1 : Operation field with Value 0 and Batch Id 1Case 2 : Now for operation field with Value 1 and Batch Id 1Case 3 : Now for operation field with Value 0 and Batch Id 2Case 4 : Now for operation field with Value 2 and Batch Id 2My Class file : This is how i have Done : I have tried like this but its a labour process : Similarly for Operation 1 : Similarly for Operation 2 : I think i have done a labour process as this can be done even in better way with linq query only i guess.So can anybody help me to simplify this whole process in linq query or even some better way and provide solution for Operation Value 2 which is left ?,"Id PupilId NutritionId1 10 100 2 10 101 Id Nutritioncategory BatchId NutritionRate NutritionId Operation1 A 1 9000 100 12 B 1 5000 100 03 C 1 5000 100 14 D 2 6000 101 2 5 E 2 7000 101 2 6 F 2 8000 101 0 decimal Rate= 0 ; Rate= Rate + NutritionRate ( i.e 5000 because for batch id 1 with condition 0 only 1 record is there ) . Here i want to sum up both the value i.e ( 10000 and 5000 ) but during addition if sum of both is greater than 10000 then just take 10000 else take sum like this : if ( 9000 + 5000 > 10000 ) Rate= 10000else Rate=Rate + ( Addition of both if less than 10000 ) . Rate= Rate + NutritionRate ( i.e 8000 because for batch id 1 with condition 0 only 1 record is there ) . Here I will select Maximum value from Nutrition Rate field if there are 2 records : Rate=Rate - ( Maximum value from 6000 and 7000 so will take 7000 ) . public partial class PupilNutrition { public int Id { get ; set ; } public int PupilId { get ; set ; } public int NutritionId { get ; set ; } } public partial class Nutrition { public int Id { get ; set ; } public string Nutritioncategory { get ; set ; } public decimal NutritionRate { get ; set ; } public Nullable < int > NutritionId { get ; set ; } } batchId=1 or 2 ; // List < int > NutritionId = db.PupilNutrition.Where ( x = > PupilId == 10 ) .Select ( c = > c.NutritionId ) .ToList ( ) ; //output 100,101 var data = db.Nutrition.Where ( x = > x.BatchId == batchId & & NutritionId.Contains ( x.NutritionId.Value ) ) .ToList ( ) ; var data1=data.where ( t= > t.Operation==0 ) ; Rate= Rate + data1.Sum ( p = > p.NutritionRate ) ; var data2=data.where ( t= > t.Operation==1 ) ; This is left because here i need to sum up 2 value if two records are there as shown in my above cases and if sum is greater than 10000 than select 10000 else select sum . var data3=data.where ( t= > t.Operation==2 ) ; Rate= Rate - data3.Max ( p = > p.NutritionRate ) ;",Simplify process with linq query
It seems exceptionally heavy handed but going by the rule anything publicly available should be tested should auto-implemented properties be tested ? Customer ClassTested by,"public class Customer { public string EmailAddr { get ; set ; } } [ TestClass ] public class CustomerTests : TestClassBase { [ TestMethod ] public void CanSetCustomerEmailAddress ( ) { //Arrange Customer customer = new Customer ( ) ; //Act customer.EmailAddr = `` foo @ bar.com '' ; //Assert Assert.AreEqual ( `` foo @ bar.com '' , customer.EmailAddr ) ; } }",Is there value in unit testing auto implemented properties
"Today while coding , visual studio notified me that my switch case could be optimized . But the code that I had vs the code that visual studio generated from my switch case does not result in the same outcome.The Enum I Used : After the following code runs the value is equal to 2147483647.But when visual studio optimized the switch case , the value becomes 2147483648.This is just the code with information that reproduced the erroneous output and not actual code that is run in production . What I found weird was that if I comment out the line State.ExampleA in the last code block the correct value is written.My Question is : Is this a bug ? Or am I missing something here ?","public enum State { ExampleA , ExampleB , ExampleC } ; State stateExample = State.ExampleB ; double value ; switch ( stateExample ) { case State.ExampleA : value = BitConverter.ToSingle ( BitConverter.GetBytes ( ( long ) 2147483646 ) , 0 ) ; break ; case State.ExampleB : value = BitConverter.ToUInt32 ( BitConverter.GetBytes ( ( long ) 2147483647 ) , 0 ) ; break ; case State.ExampleC : value = BitConverter.ToInt16 ( BitConverter.GetBytes ( ( long ) 2147483648 ) , 0 ) ; break ; default : value = 0 ; break ; } State stateExample = State.ExampleB ; double value = stateExample switch { State.ExampleA = > BitConverter.ToSingle ( BitConverter.GetBytes ( ( long ) 2147483646 ) , 0 ) , //Commenting this line results in correct value State.ExampleB = > BitConverter.ToUInt32 ( BitConverter.GetBytes ( ( long ) 2147483647 ) , 0 ) , State.ExampleC = > BitConverter.ToInt16 ( BitConverter.GetBytes ( ( long ) 2147483648 ) , 0 ) , _ = > throw new InvalidOperationException ( ) } ;",Unexpected results after optimizing switch case in Visual Studio with C # 8.0
"I am relatively new to custom controls ( writing control from scratch in code - not merely styling existing controls ) . I am having a go at replicating the YouTube video control , you know the one ... To start with I want to develop the `` timeline '' ( the transparent grey bar , which displays the current position of the video and allows the user to drag to change position ) . With the preview panel and all the rest coming later on ... I currently have the control partially rendered and the hover animations and scale working very well ... However , I am struggling to write the correct code to allow me to drag the `` thumb '' . When I try and handle my left click on the Ellipse that is representing my thumb , the leave event of the containing Canvas fires , in accordance with the WPF documentation , so no complaints , I just don ; t know how to achieve what I want and indeed if what I have done already is the correct approach . The code : The XAML styleMy questions are : Is my approach for drawing the draggable thumb correct ? How can I actually change the code to get the dragging of my `` thumb '' to work ? Thanks for your time.Ps . the GitHub project with the working code is here so you can reproduce the problem I am having . If anyone wants to help me develop this control , that would be awesome ! Pps . I am aware I could override a slider to get my functionality for the `` timeline '' , but this is just the first part of a much more comprehensive control and hence needs to be written from scratch .","[ ToolboxItem ( true ) ] [ DisplayName ( `` VideoTimeline '' ) ] [ Description ( `` Controls which allows the user navigate video media . In addition is can display a `` + `` waveform repesenting the audio channels for the loaded video media . `` ) ] // [ TemplatePart ( Name = `` PART_ThumbCanvas '' , Type = typeof ( Canvas ) ) ] [ TemplatePart ( Name = `` PART_TimelineCanvas '' , Type = typeof ( Canvas ) ) ] [ TemplatePart ( Name = `` PART_WaveformCanvas '' , Type = typeof ( Canvas ) ) ] [ TemplatePart ( Name = `` PART_PreviewCanvas '' , Type = typeof ( Canvas ) ) ] [ TemplatePart ( Name = `` PART_Thumb '' , Type = typeof ( Ellipse ) ) ] // Is this the right thing to be doing ? public class VideoTimeline : Control { private Canvas thumbCanvas ; private Canvas timelineCanvas ; private Canvas waveformCanvas ; private Canvas previewCanvas ; private Rectangle timelineOuterBox = new Rectangle ( ) ; private Rectangle timelineProgressBox = new Rectangle ( ) ; private Rectangle timelineSelectionBox = new Rectangle ( ) ; private Ellipse timelineThumb = new Ellipse ( ) ; private Path previewWindow = new Path ( ) ; private Point mouseDownPosition ; private Point currentMousePosition ; private const int TIMELINE_ANIMATION_DURATION = 400 ; private const string HIGHLIGHT_FILL = `` # 878787 '' ; private double __timelineWidth ; # region Initialization . static VideoTimeline ( ) { DefaultStyleKeyProperty.OverrideMetadata ( typeof ( VideoTimeline ) , new FrameworkPropertyMetadata ( typeof ( VideoTimeline ) ) ) ; } public override void OnApplyTemplate ( ) { base.OnApplyTemplate ( ) ; //thumbCanvas = GetTemplateChild ( `` PART_ThumbCanvas '' ) as Canvas ; //thumbCanvas.Background = new SolidColorBrush ( Colors.Transparent ) ; //thumbCanvas.Children.Add ( timelineThumb ) ; timelineThumb = EnforceInstance < Ellipse > ( `` PART_Thumb '' ) ; timelineThumb.MouseLeftButtonDown -= TimelineThumb_MouseLeftButtonDown ; timelineThumb.MouseLeftButtonDown += TimelineThumb_MouseLeftButtonDown ; timelineCanvas = GetTemplateChild ( `` PART_TimelineCanvas '' ) as Canvas ; timelineCanvas.Background = new SolidColorBrush ( Colors.Transparent ) ; timelineCanvas.Children.Add ( timelineOuterBox ) ; timelineCanvas.Children.Add ( timelineSelectionBox ) ; timelineCanvas.Children.Add ( timelineProgressBox ) ; timelineCanvas.Children.Add ( timelineThumb ) ; previewCanvas = GetTemplateChild ( `` PART_PreviewCanvas '' ) as Canvas ; previewCanvas.Background = new SolidColorBrush ( Colors.Transparent ) ; previewCanvas.Children.Add ( previewWindow ) ; } private T EnforceInstance < T > ( string partName ) where T : FrameworkElement , new ( ) { return GetTemplateChild ( partName ) as T ? ? new T ( ) ; } protected override void OnTemplateChanged ( ControlTemplate oldTemplate , ControlTemplate newTemplate ) { base.OnTemplateChanged ( oldTemplate , newTemplate ) ; if ( timelineCanvas ! = null ) timelineCanvas.Children.Clear ( ) ; SetDefaultMeasurements ( ) ; } # endregion // Initialization . # region Event Overrides . protected override void OnRenderSizeChanged ( SizeChangedInfo sizeInfo ) { base.OnRenderSizeChanged ( sizeInfo ) ; //UpdateWaveformCacheScaling ( ) ; SetDefaultMeasurements ( ) ; UpdateAllRegions ( ) ; } protected override void OnMouseLeftButtonDown ( MouseButtonEventArgs e ) { base.OnMouseLeftButtonDown ( e ) ; Canvas c = e.OriginalSource as Canvas ; if ( c == null ) c = Utils.FindParent < Canvas > ( e.OriginalSource as FrameworkElement ) ; if ( c ! = null ) { CaptureMouse ( ) ; mouseDownPosition = e.GetPosition ( c ) ; if ( c.Name == `` PART_TimelineCanvas '' ) { Trace.WriteLine ( `` OnMouseLeftDown over TimeLine '' ) ; } } } protected override void OnMouseLeftButtonUp ( MouseButtonEventArgs e ) { base.OnMouseLeftButtonUp ( e ) ; ReleaseMouseCapture ( ) ; } protected override void OnMouseMove ( MouseEventArgs e ) { base.OnMouseMove ( e ) ; currentMousePosition = e.GetPosition ( thumbCanvas ) ; if ( Mouse.Captured == null ) { Canvas c = e.OriginalSource as Canvas ; if ( c == null ) c = Utils.FindParent < Canvas > ( e.OriginalSource as FrameworkElement ) ; } } # endregion // Event Overrides . # region Drawing Methods and Events . private void UpdateAllRegions ( ) { UpdateTimelineCanvas ( ) ; } private void UpdateTimelineCanvas ( ) { if ( timelineCanvas == null ) return ; SetDefaultMeasurements ( ) ; // Bounding timeline box . timelineOuterBox.Fill = new SolidColorBrush ( ( Color ) ColorConverter.ConvertFromString ( `` # 878787 '' ) ) { Opacity = 0.25 } ; timelineOuterBox.StrokeThickness = 0.0 ; timelineOuterBox.Width = __timelineWidth ; timelineOuterBox.Height = TimelineThickness ; timelineOuterBox.Margin = new Thickness ( TimelineExpansionFactor * TimelineThickness , ( timelineCanvas.RenderSize.Height - TimelineThickness ) / 2 , 0 , 0 ) ; timelineOuterBox.SnapsToDevicePixels = true ; // Selection timeline box . timelineSelectionBox.Fill = TimelineSelectionBrush ; timelineSelectionBox.Width = 0.0 ; timelineSelectionBox.Height = TimelineThickness ; timelineSelectionBox.Margin = new Thickness ( TimelineExpansionFactor * TimelineThickness , ( timelineCanvas.RenderSize.Height - TimelineThickness ) / 2 , 0 , 0 ) ; timelineSelectionBox.SnapsToDevicePixels = true ; // Progress timeline box . timelineProgressBox.Fill = TimelineProgressBrush ; timelineProgressBox.StrokeThickness = 0.0 ; timelineProgressBox.Width = 0.0 ; timelineProgressBox.Height = TimelineThickness ; timelineProgressBox.Margin = new Thickness ( TimelineExpansionFactor * TimelineThickness , ( timelineCanvas.RenderSize.Height - TimelineThickness ) / 2 , 0 , 0 ) ; timelineProgressBox.SnapsToDevicePixels = true ; // Animation and selection . timelineCanvas.MouseEnter -= TimelineCanvas_MouseEnter ; timelineCanvas.MouseEnter += TimelineCanvas_MouseEnter ; timelineCanvas.MouseLeave -= TimelineCanvas_MouseLeave ; timelineCanvas.MouseLeave += TimelineCanvas_MouseLeave ; timelineCanvas.MouseMove -= TimelineCanvas_MouseMove ; timelineCanvas.MouseMove += TimelineCanvas_MouseMove ; timelineCanvas.MouseDown -= TimelineCanvas_MouseDown ; timelineCanvas.MouseDown += TimelineCanvas_MouseDown ; // The draggable thumb . timelineThumb.Fill = TimelineThumbBrush ; //timelineThumb.Stroke = new SolidColorBrush ( Colors.Black ) ; //timelineThumb.StrokeThickness = 0.5 ; timelineThumb.VerticalAlignment = VerticalAlignment.Center ; timelineThumb.Height = timelineThumb.Width = 0.0 ; timelineThumb.Margin = new Thickness ( TimelineExpansionFactor * TimelineThickness , timelineCanvas.RenderSize.Height / 2 , 0 , 0 ) ; timelineThumb.SnapsToDevicePixels = true ; timelineThumb.MouseLeftButtonDown -= TimelineThumb_MouseLeftButtonDown ; timelineThumb.MouseLeftButtonDown += TimelineThumb_MouseLeftButtonDown ; timelineThumb.MouseLeftButtonUp -= TimelineThumb_MouseLeftButtonUp ; timelineThumb.MouseLeftButtonUp += TimelineThumb_MouseLeftButtonUp ; // Preview window . } private void TimelineCanvas_MouseDown ( object sender , MouseButtonEventArgs e ) { Trace.WriteLine ( `` POON '' ) ; } private void SetDefaultMeasurements ( ) { if ( timelineCanvas ! = null ) __timelineWidth = timelineCanvas.RenderSize.Width - 2 * 2 * TimelineThickness ; } private void TimelineCanvas_MouseEnter ( object sender , MouseEventArgs e ) { timelineThumb.ResetAnimation ( Ellipse.WidthProperty , Ellipse.HeightProperty ) ; timelineProgressBox.ResetAnimation ( Rectangle.HeightProperty , Rectangle.MarginProperty ) ; timelineSelectionBox.ResetAnimation ( Rectangle.HeightProperty , Rectangle.MarginProperty ) ; timelineOuterBox.ResetAnimation ( Rectangle.HeightProperty , Rectangle.MarginProperty ) ; CircleEase easing = new CircleEase ( ) ; easing.EasingMode = EasingMode.EaseOut ; // Thumb animation . Thickness margin = new Thickness ( 0 , ( timelineCanvas.RenderSize.Height - 2 * TimelineExpansionFactor * TimelineThickness ) / 2 , 0 , 0 ) ; EllpiseDiameterAnimation ( timelineThumb , TimelineThickness * TimelineExpansionFactor * 2 , margin , easing ) ; // Timeline animation . margin = new Thickness ( TimelineExpansionFactor * TimelineThickness , ( timelineCanvas.RenderSize.Height - ( TimelineThickness * TimelineExpansionFactor ) ) / 2 , 0 , 0 ) ; TimelineHeightAnimation ( timelineProgressBox , TimelineThickness * TimelineExpansionFactor , margin , easing ) ; TimelineHeightAnimation ( timelineSelectionBox , TimelineThickness * TimelineExpansionFactor , margin , easing ) ; TimelineHeightAnimation ( timelineOuterBox , TimelineThickness * TimelineExpansionFactor , margin , easing ) ; double selectionWidth = ( currentMousePosition.X / RenderSize.Width ) * timelineOuterBox.Width ; timelineSelectionBox.Width = selectionWidth ; Trace.WriteLine ( `` MouseENTER Canvas '' ) ; } private void TimelineCanvas_MouseLeave ( object sender , MouseEventArgs e ) { timelineThumb.ResetAnimation ( Ellipse.WidthProperty , Ellipse.HeightProperty ) ; timelineProgressBox.ResetAnimation ( Rectangle.HeightProperty , Rectangle.MarginProperty ) ; timelineSelectionBox.ResetAnimation ( Rectangle.HeightProperty , Rectangle.MarginProperty ) ; timelineOuterBox.ResetAnimation ( Rectangle.HeightProperty , Rectangle.MarginProperty ) ; CircleEase easing = new CircleEase ( ) ; easing.EasingMode = EasingMode.EaseOut ; // Thumb animation . Thickness margin = new Thickness ( TimelineExpansionFactor * TimelineThickness , timelineCanvas.RenderSize.Height / 2 , 0 , 0 ) ; EllpiseDiameterAnimation ( timelineThumb , 0.0 , margin , easing ) ; // Timeline animation . margin = new Thickness ( TimelineExpansionFactor * TimelineThickness , ( timelineCanvas.RenderSize.Height - TimelineThickness ) / 2 , 0 , 0 ) ; TimelineHeightAnimation ( timelineProgressBox , TimelineThickness , margin , easing ) ; TimelineHeightAnimation ( timelineSelectionBox , TimelineThickness , margin , easing ) ; TimelineHeightAnimation ( timelineOuterBox , TimelineThickness , margin , easing ) ; if ( ! isDraggingThumb ) timelineSelectionBox.Width = 0.0 ; Trace.WriteLine ( `` MouseLeave Canvas '' ) ; } private void TimelineCanvas_MouseMove ( object sender , MouseEventArgs e ) { Point relativePosition = e.GetPosition ( timelineOuterBox ) ; double selectionWidth = ( relativePosition.X / timelineOuterBox.Width ) * timelineOuterBox.Width ; timelineSelectionBox.Width = selectionWidth.Clamp ( 0.0 , timelineOuterBox.Width ) ; if ( isDraggingThumb ) { timelineProgressBox.Width = timelineSelectionBox.Width ; Thickness thumbMargin = new Thickness ( TimelineExpansionFactor * TimelineThickness , ( timelineCanvas.RenderSize.Height - ( TimelineThickness * TimelineExpansionFactor ) ) / 2 , 0 , 0 ) ; timelineThumb.Margin = thumbMargin ; } } private bool isDraggingThumb = false ; private void TimelineThumb_MouseLeftButtonDown ( object sender , MouseButtonEventArgs e ) { CaptureMouse ( ) ; isDraggingThumb = true ; Trace.WriteLine ( `` Dragging Thumb '' ) ; } private void TimelineThumb_MouseLeftButtonUp ( object sender , MouseButtonEventArgs e ) { ReleaseMouseCapture ( ) ; isDraggingThumb = false ; Trace.WriteLine ( `` STOPPED Dragging Thumb '' ) ; } # endregion // Drawing Methods and Events . # region Animation Methods . private void EllpiseDiameterAnimation ( Ellipse ellipse , double diameter , Thickness margin , IEasingFunction easing ) { AnimationTimeline widthAnimation = ShapeWidthAnimation ( ellipse , diameter , easing ) ; AnimationTimeline heightAnimation = ShapeHeightAnimation ( ellipse , diameter , easing ) ; AnimationTimeline marginAnimation = ShapeMarginAnimation ( ellipse , margin , easing ) ; Storyboard storyboard = new Storyboard ( ) ; storyboard.Children.Add ( widthAnimation ) ; storyboard.Children.Add ( heightAnimation ) ; storyboard.Children.Add ( marginAnimation ) ; storyboard.Begin ( this ) ; } private void TimelineHeightAnimation ( Rectangle rectangle , double height , Thickness margin , IEasingFunction easing ) { AnimationTimeline heightAnimation = ShapeHeightAnimation ( rectangle , height , easing ) ; AnimationTimeline marginAnimation = ShapeMarginAnimation ( rectangle , margin , easing ) ; Storyboard storyboard = new Storyboard ( ) ; storyboard.Children.Add ( marginAnimation ) ; storyboard.Children.Add ( heightAnimation ) ; storyboard.Begin ( this ) ; } private AnimationTimeline ShapeMarginAnimation ( Shape shape , Thickness margin , IEasingFunction easing ) { ThicknessAnimation marginAnimation = new ThicknessAnimation ( margin , TimeSpan.FromMilliseconds ( ( TIMELINE_ANIMATION_DURATION ) ) ) ; if ( easing ! = null ) marginAnimation.EasingFunction = easing ; Storyboard.SetTarget ( marginAnimation , shape ) ; Storyboard.SetTargetProperty ( marginAnimation , new PropertyPath ( Rectangle.MarginProperty ) ) ; return marginAnimation ; } private AnimationTimeline ShapeWidthAnimation ( Shape shape , double width , IEasingFunction easing ) { DoubleAnimation widthAnimation = new DoubleAnimation ( width , TimeSpan.FromMilliseconds ( TIMELINE_ANIMATION_DURATION ) ) ; if ( easing ! = null ) widthAnimation.EasingFunction = easing ; Storyboard.SetTarget ( widthAnimation , shape ) ; Storyboard.SetTargetProperty ( widthAnimation , new PropertyPath ( Shape.WidthProperty ) ) ; return widthAnimation ; } private AnimationTimeline ShapeHeightAnimation ( Shape shape , double height , IEasingFunction easing ) { DoubleAnimation heightAnimation = new DoubleAnimation ( height , TimeSpan.FromMilliseconds ( TIMELINE_ANIMATION_DURATION ) ) ; if ( easing ! = null ) heightAnimation.EasingFunction = easing ; Storyboard.SetTarget ( heightAnimation , shape ) ; Storyboard.SetTargetProperty ( heightAnimation , new PropertyPath ( Shape.HeightProperty ) ) ; return heightAnimation ; } # endregion // Animation Methods . // Lots of DependencyProperties here ... } < ResourceDictionary xmlns= '' http : //schemas.microsoft.com/winfx/2006/xaml/presentation '' xmlns : x= '' http : //schemas.microsoft.com/winfx/2006/xaml '' xmlns : local= '' clr-namespace : MediaControlBuilder '' > < Style TargetType= '' { x : Type local : VideoTimeline } '' > < Setter Property= '' TimelineProgressBrush '' Value= '' DarkOrange '' / > < Setter Property= '' Template '' > < Setter.Value > < ControlTemplate TargetType= '' { x : Type local : VideoTimeline } '' > < Border Background= '' { TemplateBinding Background } '' BorderBrush= '' { TemplateBinding BorderBrush } '' BorderThickness= '' { TemplateBinding BorderThickness } '' > < Grid > < Grid.RowDefinitions > < ! -- < RowDefinition Height= '' * '' / > -- > < ! -- < RowDefinition Height= '' 15 '' / > -- > < RowDefinition Height= '' * '' / > < RowDefinition Height= '' 20 '' / > < ! -- < RowDefinition Height= '' * '' / > -- > < /Grid.RowDefinitions > < Canvas Name= '' PART_PreviewCanvas '' Grid.Row= '' 0 '' ClipToBounds= '' True '' / > < Canvas Name= '' PART_ThumbCanvas '' Grid.Row= '' 1 '' ClipToBounds= '' True '' / > < Canvas Name= '' PART_TimelineCanvas '' Grid.Row= '' 1 '' ClipToBounds= '' True '' / > < Canvas Name= '' PART_WaveformCanvas '' Grid.Row= '' 1 '' ClipToBounds= '' True '' / > < /Grid > < /Border > < /ControlTemplate > < /Setter.Value > < /Setter > < /Style > < /ResourceDictionary >",WPF Video Transport Control
"I have a method that currently takes a Func < Product , string > as a parameter , but I need it to be an Expression < Func < Product , string > > . Using AdventureWorks , here 's an example of what I 'd like to do using the Func.I would like it to look something like this : However , the problem I 'm running into is that myExpression ( product ) is invalid ( wo n't compile ) . After reading some other posts I understand why . And if it was n't for the fact that I need the product variable for the second part of my key I could probably say something like this : But I do need the product variable because I do need the second part of the key ( ProductNumber ) . So I 'm not really sure what to do now . I ca n't leave it as a Func because that causes problems . I ca n't figure out how to use an Expression because I do n't see how I could pass it the product variable . Any ideas ? EDIT : Here 's an example of how I would call the method :","private static void DoSomethingWithFunc ( Func < Product , string > myFunc ) { using ( AdventureWorksDataContext db = new AdventureWorksDataContext ( ) ) { var result = db.Products.GroupBy ( product = > new { SubCategoryName = myFunc ( product ) , ProductNumber = product.ProductNumber } ) ; } } private static void DoSomethingWithExpression ( Expression < Func < Product , string > > myExpression ) { using ( AdventureWorksDataContext db = new AdventureWorksDataContext ( ) ) { var result = db.Products.GroupBy ( product = > new { SubCategoryName = myExpression ( product ) , ProductNumber = product.ProductNumber } ) ; } } var result = db.Products.GroupBy ( myExpression ) ; DoSomethingWithFunc ( product = > product.ProductSubcategory.Name ) ;",Refactoring Func < T > into Expression < Func < T > >
"I 'm trying to use SQLXMLBulkLoader4 from C # code into an SQL 2008 DB . But for some reason it does n't insert any rows at all despite not throwing any error . I 've made use of the bulkloads own ErrorLog file , ( to check for any errors that might not cause it to crash ) , but no error is reported.I have a XML file that is downloaded from a supplier ( basically a list of products ) , I wrote an XSD to match the fields to our DB . There is nothing else writing to those specific tables , and nothing else using those files.My BulkLoad code looks as follows ( I X'ed out the actual connection string values ) : The XML looks like this ( stripped down , everything below is just a couple more product-fields and then more products ) : The XSD I wrote looks like this ( again shortened ) : I 've stared myself blind at the namespaces , but they look correct to me . ( Read about a lot of similar errors where different namespaces was the cause ) .The code is running from my computer , both my computer and the one with the DB have access to the network folder with the XML and XSD files.I 've tried deliberately changing some field-names in both files , and the BulkLoader flares up throwing an error on the field I just changed.I 've compared both my BulkLoader code and the XSD to examples I 've found on the net , and I ca n't find any difference that would account for this behaviour.It 's probably something easy I 'm overlooking , but I 'm just not seeing it atm.Any help at all pointing me in the right direction is deeply welcomed.Thank you in advance ! ( P.S . Sorry if the post is off in some way , it 's my first time posting here , I did do my research however and I did try to follow the guidelines on how to post = ) )","public void Bulkload ( string schemaFile , string xmlFile , string source ) { SQLXMLBULKLOADLib.SQLXMLBulkLoad4 bulkload = new SQLXMLBULKLOADLib.SQLXMLBulkLoad4 ( ) ; try { bulkload.ConnectionString = `` Provider=sqloledb ; server=X ; database=X ; uid=X ; pwd=X '' ; bulkload.ErrorLogFile = k_ArticleInfoDirectory + source + `` BulkLoadError.log '' ; bulkload.KeepIdentity = false ; bulkload.Execute ( schemaFile , xmlFile ) ; } catch ( Exception e ) { Console.WriteLine ( `` Fel i BL : `` + e ) ; throw ; } finally { bulkload = null ; } } < ? xml version= '' 1.0 '' encoding= '' utf-8 '' ? > < GetProductsResult xmlns : xsi= '' http : //www.w3.org/2001/XMLSchema-instance '' xmlns : xsd= '' http : //www.w3.org/2001/XMLSchema '' > < Status xmlns= '' http : //schemas.servicestack.net/types '' > < Code > 0 < /Code > < Message > Ok < /Message > < /Status > < NumberOfProducts xmlns= '' http : //schemas.servicestack.net/types '' > 9826 < /NumberOfProducts > < Products xmlns= '' http : //schemas.servicestack.net/types '' > < Product > < ProductID > 1000002 < /ProductID > < CreatedDate > 2011-11-24 15:54 < /CreatedDate > < UpdatedDate > 2011-11-24 15:54 < /UpdatedDate > < Title > Vi tolererar inga förlorare - klanen Kennedy < /Title > < Publisher > Piratförlaget < /Publisher > ... And some more fields per Product < ? xml version= '' 1.0 '' encoding= '' iso-8859-1 '' ? > < xs : schema targetNamespace= '' http : //schemas.servicestack.net/types '' xmlns : xs= '' http : //www.w3.org/2001/XMLSchema '' attributeFormDefault= '' qualified '' elementFormDefault= '' qualified '' xmlns : sql= '' urn : schemas-microsoft-com : mapping-schema '' > < xs : annotation > < xs : appinfo > < sql : relationship name= '' Status '' parent= '' tblElibProduct '' parent-key= '' id '' child= '' tblElibStatus '' child-key= '' product_id '' / > ... + Several other sql : relationships < /xs : appinfo > < /xs : annotation > < xs : element name= '' GetProductsResult '' sql : is-constant= '' 1 '' > < xs : complexType > < xs : sequence > < xs : element name= '' Status '' sql : is-constant= '' 1 '' > < xs : complexType > < xs : sequence > < xs : element name= '' Code '' type= '' xs : integer '' minOccurs= '' 0 '' / > < xs : element name= '' Message '' type= '' xs : string '' minOccurs= '' 0 '' / > < /xs : sequence > < /xs : complexType > < /xs : element > < xs : element name= '' NumberOfProducts '' type= '' xs : string '' sql : is-constant= '' 1 '' / > < xs : element name= '' Products '' sql : is-constant= '' 1 '' > < xs : complexType > < xs : sequence > < xs : element minOccurs= '' 0 '' maxOccurs= '' unbounded '' name= '' Product '' sql : relation= '' tblElibProduct '' > < xs : complexType > < xs : sequence > < xs : element minOccurs= '' 1 '' maxOccurs= '' 1 '' name= '' CreatedDate '' type= '' xs : date '' sql : field= '' created_date '' / > < xs : element minOccurs= '' 1 '' maxOccurs= '' 1 '' name= '' UpdatedDate '' type= '' xs : date '' sql : field= '' updated_date '' / > < xs : element minOccurs= '' 1 '' maxOccurs= '' 1 '' name= '' Title '' type= '' xs : string '' sql : field= '' title '' / >",SQLXML BulkLoader not throwing any error but no data is inserted
"I 'm using IdentityServer4 with ASP.NET Core 2.2 . On the Post Login method I have applied the ValidateAntiForgeryToken . Generally after 20 minutes to 2 hours of sitting on the login page and then attempting to login it produces a blank page . If you look at Postman Console you get a 400 Bad Request message . I then set the Cookie Expiration on the AntiForgery options to 90 days . I was able to allow the page to sit for up to 6 hours and still login . However , after around 8 hours ( overnight ) , I received the blank page again after attempting to login.I expect to be able to sit on the login page for 90 days which is the duration of the cookie but that does n't work . How do I get the cookie for the AntiforgeryToken to last the entire 90 days or whatever time I set it to and not timeout or expire ? Is there a way to catch this error and redirect the user back to the login method ?",[ HttpPost ] [ ValidateAntiForgeryToken ] public async Task < IActionResult > Login services.AddAntiforgery ( options = > { options.Cookie.Expiration = TimeSpan.FromDays ( 90 ) ; } ) ;,AntiForgeryToken Expiration Blank Page
"Update : This is called a de Brujin torus , but I still need to figure out a simple algoritm in C # .http : //en.wikipedia.org/wiki/De_Bruijn_torushttp : //datagenetics.com/blog/october22013/index.htmlI need to combine all values of a 3x3 bit grid as densely as possible . By a 3x3 bit grid , I mean a 3x3 grid where each place is a bit similar to the hole punch concept in this question : Find all combinations of 3x3 holepunch3x3 Bit Grid Examples : GoalI want to pack all 512 ( actually 256 because the center bit is always on ) possible values so that they overlap in a single NxM grid.Incomplete Example : This example packs ~25 of the possible values into a 7x7 grid.Things already known : There are 2^9 ( 512 ) unique values.I only care about 2^8 ( 256 ) values because I need the center bit always on.AttemptsI tried many different techniques by hand , but could not come up with a straightforward algorithm.So , I would like to write a C # program to create this , but I also did not see an easy way . There is not even an obvious brute-force approach that seems possible to me . It seems any brute-force attempt would approach 512 ! combinations in the worse case.ObservationsEach edge only has 8 possible values . PurposeThis is actually going to be used for a 2d tile-based game.The game has N possible ground pieces . Given that the ground can occur in any situation , the designer needs a way to express which tile should be chosen for any given situation.A compact grid that contains every possible situation is the most efficient way to specify which tile to use in each situation and eliminates all redundancy.UpdateExampleThe above is the base pattern that will allow the expression of 4 situations and I will modify this to use other ascii values to represent the result that should be used in each situation : Where A , G , H each represent a specific pattern that should be used for each situation.So , if the following pattern is found : This matches the pattern that results in ' A ' above , so ' A ' will be used in that situation . The purpose is to have an exhaustive expression of what each possible situation would result.In PracticeI was able to attempt this , and found the results too random to work well to achieve the goals . As a human , it was difficult to choose the correct values in each situation because or the disorganization . Manual grouping of similar patterns still works better .",XXX .X . ... XXX .X . .X.XXX .X . ... ... ... ..X.XXX ... ... ... X.XXX..X.XXX..X.XXX ... ... .. X ... X.XXX . // ( 8+2 bits ) Exhausts all values in the same problem with 1-Dimension..X.XXX . // ( 5+2 bits ) The above simplifies when the center bit must be on . ... ..XX..XX ... .. ... ..AG..HH ... .. ... .XX.XX ? ? ? ? A ? ? ? ?,Find a NxM grid that contains all possible 3x3 bit patterns
"I 'm learning TDD . I know about dependency injection whereby you place the class 's dependencies in the constructor 's parameters and have them passed in , passing in default implementations from the default constructor eg ; RepositoryFactory is a simple static class that returns the chosen implementations for the current buildBut the default ASP.NET MVC web app project does n't do this , instead the DI takes the form of public properties that are assigned in the object initializer in the test class eg ; from AccountController.cs : And in the test class AccountControllerTest.cs : So now my AccountController class has two approaches to dependency injection . Which one should I use ? Constructor injection or public properties ? Am thinking constructor injection ... Is the ASP.NET MVC use of public properties like that because you need to provide a specific way of injecting into the constructor , and the basic `` create new '' web app needs to be generic as a starting point ?","public AccountController ( ) : this ( RepositoryFactory.Users ( ) ) { } public AccountController ( IUserRepository oUserRepository ) { m_oUserRepository = oUserRepository ; } protected override void Initialize ( RequestContext requestContext ) { if ( FormsService == null ) { FormsService = new FormsAuthenticationService ( ) ; } if ( MembershipService == null ) { MembershipService = new AccountMembershipService ( ) ; } base.Initialize ( requestContext ) ; } private static AccountController GetAccountController ( ) { AccountController controller = new AccountController ( ) { FormsService = new MockFormsAuthenticationService ( ) , MembershipService = new MockMembershipService ( ) , Url = new UrlHelper ( requestContext ) , } ; //snip }",Are the unit test classes in ASP.NET MVC web project a good example ?
